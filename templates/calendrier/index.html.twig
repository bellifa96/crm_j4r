{% extends 'base.html.twig' %}

{% block title %}
	Commandes
{% endblock %}

{% block body %}
	<!-- Include Bootstrap JS (and jQuery) -->


	<style>
		.container {
			display: flex;
			align-items: center;
			justify-content: space-between;
			width: 100%; /* Set your desired width */
			padding: 10px;
		}

		.left {
			flex: 1; /* Takes up available space on the left */

		}

		.right {
			flex: 2; /* Takes up available space on the right */
			margin-left: 20px; /* Add margin for spacing between left and right */
		}

		select {
			width: 20%;
			padding: 5px;
		}
		.title_article {
			font-family: 'Poppins', sans-serif;
			color: black;
			font-size: 30px;
			margin-left: 10%;
		}
		.basic {
			width: 160px;
			height: 35px;
			background: #f5f5f5;
			font-family: 'Poppins', sans-serif;
			margin-left: 2%;

		}
		.custom-dialog {
			max-width: 400px;
			margin: 50px auto;
			background-color: #fff;
			padding: 20px;
			border-radius: 8px;
			box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
		}

		#overlay {
			display: none;
			position: fixed;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			background-color: rgba(0, 0, 0, 0.5); /* semi-transparent black */
			z-index: 999; /* Ensure it's above the dialog */
		}
		.right {
			flex: 2; /* Takes up available space on the right */
			margin-left: 20px; /* Add margin for spacing between left and right */
			display: flex;
			justify-content: flex-end;

		}
		.btnChargerCommande {}
	</style>

	<div class="example-wrapper">
		<div class="container">

			<div class="right">
				<div class="col-md-4 ">
					<div class="form-group">
						<label for="DateDu" class="font-weight-bold">DU</label>
						<input type="date" id="DateDu" name="DateDu" class="form-control form-control-sm-2 societe-input required" value="">
					</div>
				</div>
				<div class="col-md-4 ">
					<div class="form-group">
						<label for="DateAu" class="font-weight-bold">Au</label>
						<input type="date" id="DateAu" name="DateAu" class="form-control form-control-sm-2 societe-input required" value="">
					</div>

				</div>
				<div class="">
					<button class="basic" id="creer">
						<span>
							Cr√©er
						</span>
					</button>
				</div>
			</div>
		</div>
	</div>


	<div class="page-block col-lg-12">
		<table class="table text-center datatable" id="eventTable" style="color: #0E4377;">
			<thead>
				<tr class="tr-head">
					<th>Titre</th>
					<th>Start</th>
					<th>End</th>
				</tr>
			</thead>
			<tbody></tbody>
		</tbody>
	</table>
</div>
<script>
	document.getElementById('DateDu').addEventListener('change', function () {
var minDateDu = this.value;

document.getElementById('DateAu').min = minDateDu;
getEvent();

});
document.getElementById('DateAu').addEventListener('change', function () {
var minDateDu = this.value;
document.getElementById('DateDu').max = minDateDu;
getEvent();
});
function getEvent() {
let DateDu = document.getElementById('DateDu').value;
let DateAu = document.getElementById('DateAu').value;

console.log(DateAu);
console.log(DateDu);

$.ajax({
type: "GET",
url: "/event-date",
data: {
datedu: transormDate(DateDu),
dateau: transormDate(DateAu)
},
success: function (data) {
var eventTable;
if ($.fn.DataTable.isDataTable('#eventTable')) {
$('#eventTable').DataTable().destroy();
}

eventTable = $('#eventTable').DataTable({paging: true});
eventTable.clear().draw();
let dt = data.value;
console.log(dt);
// Populate the table with the new data
for (var i = 0; i < dt.length; i++) {
var event = dt[i];
var newRow = [event.subject, event.start.dateTime, event.end.dateTime];
eventTable.row.add(newRow);
}

eventTable.draw();
},
error: function (error) {
console.log(error);
}
});


}
function transormDate(dateTransorm) {
let dateObject = new Date(dateTransorm);

// Transform the date to the format YYYY-MM-DD
let transformedDate = `${
dateObject.getFullYear()
}-${
(dateObject.getMonth() + 1).toString().padStart(2, '0')
}-${
dateObject.getDate().toString().padStart(2, '0')
}`;

return transformedDate;
}
</script>{% endblock %}
